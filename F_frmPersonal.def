CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

'Dim newRecord As Boolean
'newRecord = False

Private Sub btnAnlegen_Click()
DoCmd.GoToRecord , , acNewRec
'newRecord = True
    'DoCmd.RefreshRecord


End Sub

Private Sub btnLoeschen_Click()
'DoCmd.RunCommand acCmdDeleteRecord

If newRecord = True Then
DoCmd.Restore
Form.Undo

'DoCmd.GoToRecord , , acNewRec


    Exit Sub
End If

If MsgBox("Person wirklich löschen? Dieser Vorgang kann nicht rückgängig gemacht werden.", vbExclamation + vbYesNo, "Person löschen") = vbYes Then
    DoCmd.SetWarnings False
        DoCmd.RunCommand acCmdSelectRecord
        DoCmd.RunCommand acCmdDeleteRecord
        DoCmd.RefreshRecord

        
    DoCmd.SetWarnings True
Else 'user clicked no
    MsgBox "Person wurde nicht gelöscht.", vbInformation
End If



End Sub

Private Sub btnSpeichern_Click()

DoCmd.SetWarnings False
DoCmd.RunCommand acCmdSaveRecord
    'DoCmd.GoToRecord , , acNewRec
    
    DoCmd.RefreshRecord
    
End Sub



' 3022 nicht eindeutig
' 3314 nicht alle Felder ausgefüllt


Private Sub Form_Error(DataErr As Integer, Response As Integer)

Select Case DataErr

Case 3314 ' nicht alle Pflichtfelder ausgefüllt

MsgBox ("Bitte alle Pflichfelder ausfüllen")
Me.Undo
Response = acDataErrContinue
End Select
End Sub

Private Sub txtPersonalVorname_GotFocus()
DoCmd.SetWarnings False
End Sub
